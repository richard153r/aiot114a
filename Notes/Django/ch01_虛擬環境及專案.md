# 虛擬環境指令筆記

## venv / virtualenv

### 1. 建立與管理虛擬環境

- **建立環境**：

    ``` powershell
    # 使用 virtualenv
    virtualenv <環境名稱>

    # (推薦) 使用 Python 內建的 venv
    python -m venv <環境名稱>
    ```

    > 筆記：`virtualenv` 適用於舊版 Python，`venv` 則是 Python 3.3+ 的內建工具，用法類似。

- **刪除環境**：

    ```powershell
    # venv/virtualenv 環境就是一個資料夾，直接刪除即可
    Remove-Item -Recurse -Force <環境名稱>
    ```

### 2. 啟用與停用虛擬環境

- **啟用環境**：

    ```powershell
    # 適用於 PowerShell
    .\<環境名稱>\Scripts\Activate.ps1
    # CMD 會自動尋找。
    <環境名稱>\Scripts\activate
    ```

- **停用環境**：

    ```powershell
    deactivate
    ```

---

## conda

### 1. 建立與管理虛擬環境

- **建立環境**：

    ```powershell
    conda create --name <環境名稱> python=3.11
    ```

    > 筆記：conda 更全面，適合資料科學或跨語言專案。

- **刪除環境**：

    ```powershell
    conda env remove --name <環境名稱>
    ```

- **查看所有環境**：

    ```powershell
    conda info --envs
    ```

### 2. 啟用與停用虛擬環境

- **啟用環境**：

    ```powershell
    conda activate <環境名稱>
    ```

- **停用環境**：

    ```powershell
    conda deactivate
    ```

    > 筆記：此指令也可用來退出 `(base)` 環境。

### 3. 建立資料夾

```powershell
# 1. 建立專案資料夾並進入
md <資料夾名稱>         # 建立新資料夾
cd <資料夾名稱>         # 進入資料夾

# 2. 安裝 Django
pip install django # 在當前虛擬環境中安裝 Django 套件

# 3. 建立 Django 專案
#    注意：指令結尾的點(.)表示將專案建立在當前資料夾
django-admin startproject <資料夾名稱> .

# 4. 建立 App
#    這個指令必須在包含 manage.py 檔案的目錄下執行
python manage.py startapp mysite
```

![20250817223937](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250817223937.png)

---

## 編輯 `steeings.py`

- `ALLOWED_HOSTS = ['*']` 的調整是為了安全防護
- `INSTALLED_APPS = ['mysite']` 則是為了啟用你新建立的應用程式。
![20250817221319](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250817221319.png)

- 調整時區
![20250817221635](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250817221635.png)

---

## 資料庫遷移指令

### 1. 產生遷移檔案 (Makemigrations)

`python manage.py makemigrations`

- **用途**：掃描 App 中的 `models.py` 檔案，偵測任何資料庫模型的變更（例如：新增、修改、刪除）。
- **結果**：如果偵測到變更，會在你 App 的 `migrations` 資料夾下產生一個新的遷移檔案。

### 2. 執行遷移 (Migrate)

`python manage.py migrate`

- **用途**：執行所有未應用的遷移檔案，將資料庫結構的變更實際應用到資料庫中。
- **結果**：在你的 `db.sqlite3` 檔案中建立、修改或刪除資料表，使其與 `models.py` 的定義保持一致。

![20250817224920](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250817224920.png)

---

## 定義資料模型

### 修改mysite/models.py

![20250819203326](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250819203326.png)

```powershell
#再次輸入，讓模型生效
python manage.py makemigrations
python manage.py migrate
```

![20250819203837](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250819203837.png)

### 啟用admin管理介面

`python manage.py createsuperuser` 建立使管理者帳號

![20250819204215](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250819204215.png)

再來修改 mysite/admin.py
![20250819204509](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250819204509.png)

修改完成後，`python manage.py runserver`
到瀏覽器 127.0.0.1:8000/admin，就可以看到登入畫面
![20250819204651](https://raw.githubusercontent.com/richard153r/pic/main/pic/20250819204651.png)